
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" 
"http://www.w3.org/TR/REC-html40/strict.dtd">
<html>

    <head>

        <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=ISO-8859-1">
        <META NAME=KEYWORDS CONTENT="C++ SDL 2 Tutorial 2D Windows Linux Mac Render to Texture">
        <META NAME=DESCRIPTION CONTENT="Render to a texture in SDL 2">

        <title>Lazy Foo' Productions - Render to Texture</title>

        <link REL="stylesheet" TYPE="text/css" href="../../../layout/lazy.css">

    </head>

    <body>

        <div class="header">

<h1 style="margin-bottom:0px;padding-bottom:0px;border-bottom:0px;">Lazy Foo' Productions</h1>
<div class="nav">
<a class="nav" href="http://forums.libsdl.org/">SDL Forums</a>
<a class="nav" href="../index.php.html">SDL Tutorials</a>
<a class="nav" href="../../../articles/index.php.html">Articles</a>
<a class="nav" href="../../OpenGL/index.php.html">OpenGL Tutorials</a>
<a class="nav" href="http://www.opengl.org/discussion_boards/forum.php">OpenGL Forums</a>
<div class="ads">
<script type="text/javascript"><!--
google_ad_client = "pub-5880704953225255";
google_ad_width = 468;
google_ad_height = 60;
google_ad_format = "468x60_as";
google_ad_type = "text_image";
google_ad_channel ="";
google_color_border = "6699CC";
google_color_bg = "003366";
google_color_link = "FFFFFF";
google_color_url = "AECCEB";
google_color_text = "AECCEB";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</div><a class="nav" href="../../../index.php.html">News</a>
<a class="nav" href="../../../faq.php.html">FAQs</a>
<!--<a class="nav" href="http://lazyfoo.net/games/index.php">Games</a>-->
<a class="nav" href="../../../contact.php.html">Contact</a>
<a class="nav" href="../../../donate.php.html">Donations</a>

</div><script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-32350292-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
<!--Init facebook-->
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.0";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>

<!--Init twitter-->
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="https://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>

<!--Init google+-->
<script src="https://apis.google.com/js/plusone.js"></script>
</div>        
        <div class="content">

            <div class="tutPreface"><h1 class="tutHead">Render to Texture</h1>
            <div class="tutImg"><img src="preview.png"></div>
            <h6>Last Updated 5/25/14</h6>
            For some effects being able to render a scene to texture is needed. Here we'll be rendering a scene to a texture to achieve a spinning scene effect.
            </div>
            

<div class="tutCode">//Texture wrapper class
class LTexture
{
    public:
        //Initializes variables
        LTexture();

        //Deallocates memory
        ~LTexture();

        //Loads image at specified path
        bool loadFromFile( std::string path );
        
        #ifdef _SDL_TTF_H
        //Creates image from font string
        bool loadFromRenderedText( std::string textureText, SDL_Color textColor );
        #endif

        //Creates blank texture
        bool createBlank( int width, int height, SDL_TextureAccess = SDL_TEXTUREACCESS_STREAMING );

        //Deallocates texture
        void free();

        //Set color modulation
        void setColor( Uint8 red, Uint8 green, Uint8 blue );

        //Set blending
        void setBlendMode( SDL_BlendMode blending );

        //Set alpha modulation
        void setAlpha( Uint8 alpha );
        
        //Renders texture at given point
        void render( int x, int y, SDL_Rect* clip = NULL, double angle = 0.0, SDL_Point* center = NULL, SDL_RendererFlip flip = SDL_FLIP_NONE );

        //Set self as render target
        void setAsRenderTarget();

        //Gets image dimensions
        int getWidth();
        int getHeight();

        //Pixel manipulators
        bool lockTexture();
        bool unlockTexture();
        void* getPixels();
        void copyPixels( void* pixels );
        int getPitch();
        Uint32 getPixel32( unsigned int x, unsigned int y );

    private:
        //The actual hardware texture
        SDL_Texture* mTexture;
        void* mPixels;
        int mPitch;

        //Image dimensions
        int mWidth;
        int mHeight;
};
</div>

<div class="tutText">
Here we are adding more functionality to the texture class. The createBlank function now takes in another argument that defines how it is accessed. We also have the setAsRenderTarget
function which makes it so we can render to this texture.
</div>


<div class="tutCode">bool LTexture::createBlank( int width, int height, SDL_TextureAccess access )
{
    //Create uninitialized texture
    mTexture = SDL_CreateTexture( gRenderer, SDL_PIXELFORMAT_RGBA8888, access, width, height );
    if( mTexture == NULL )
    {
        printf( "Unable to create blank texture! SDL Error: %s\n", SDL_GetError() );
    }
    else
    {
        mWidth = width;
        mHeight = height;
    }

    return mTexture != NULL;
}
</div>

<div class="tutText">
When we want to render to a texture we need to set its texture access to <a class="tutLink" href="http://wiki.libsdl.org/SDL_TextureAccess">SDL_TEXTUREACCESS_TARGET</a>, which is
why this function takes an additional argument now.
</div>


<div class="tutCode">void LTexture::setAsRenderTarget()
{
    //Make self render target
    SDL_SetRenderTarget( gRenderer, mTexture );
}
</div>

<div class="tutText">
To render to a texture we have to set it as the render target which is done here using a call to
<a class="tutLink" href="http://wiki.libsdl.org/SDL_SetRenderTarget">SDL_SetRenderTarget</a>.
</div>


<div class="tutCode">bool loadMedia()
{
    //Loading success flag
    bool success = true;

    //Load texture target
    if( !gTargetTexture.createBlank( SCREEN_WIDTH, SCREEN_HEIGHT, SDL_TEXTUREACCESS_TARGET ) )
    {
        printf( "Failed to create target texture!\n" );
        success = false;
    }

    return success;
}
</div>

<div class="tutText">
We create our target texture in the media loading function.
</div>


<div class="tutCode">            //Main loop flag
            bool quit = false;

            //Event handler
            SDL_Event e;

            //Rotation variables
            double angle = 0;
            SDL_Point screenCenter = { SCREEN_WIDTH / 2, SCREEN_HEIGHT / 2 };
</div>

<div class="tutText">
For this demo we'll render some geometry to a texture and spin that texture around the center of the screen. This is why we have variables for angle of rotation and center of screen.
</div>


<div class="tutCode">            //While application is running
            while( quit == false )
            {
                //Handle events on queue
                while( SDL_PollEvent( &e ) != 0 )
                {
                    //User requests quit
                    if( e.type == SDL_QUIT )
                    {
                        quit = true;
                    }
                }

                //rotate
                angle += 2;
                if( angle > 360 )
                {
                    angle -= 360;
                }

                //Set self as render target
                gTargetTexture.setAsRenderTarget();

                //Clear screen
                SDL_SetRenderDrawColor( gRenderer, 0xFF, 0xFF, 0xFF, 0xFF );
                SDL_RenderClear( gRenderer );

                //Render red filled quad
                SDL_Rect fillRect = { SCREEN_WIDTH / 4, SCREEN_HEIGHT / 4, SCREEN_WIDTH / 2, SCREEN_HEIGHT / 2 };
                SDL_SetRenderDrawColor( gRenderer, 0xFF, 0x00, 0x00, 0xFF );        
                SDL_RenderFillRect( gRenderer, &fillRect );

                //Render green outlined quad
                SDL_Rect outlineRect = { SCREEN_WIDTH / 6, SCREEN_HEIGHT / 6, SCREEN_WIDTH * 2 / 3, SCREEN_HEIGHT * 2 / 3 };
                SDL_SetRenderDrawColor( gRenderer, 0x00, 0xFF, 0x00, 0xFF );        
                SDL_RenderDrawRect( gRenderer, &outlineRect );
                
                //Draw blue horizontal line
                SDL_SetRenderDrawColor( gRenderer, 0x00, 0x00, 0xFF, 0xFF );        
                SDL_RenderDrawLine( gRenderer, 0, SCREEN_HEIGHT / 2, SCREEN_WIDTH, SCREEN_HEIGHT / 2 );

                //Draw vertical line of yellow dots
                SDL_SetRenderDrawColor( gRenderer, 0xFF, 0xFF, 0x00, 0xFF );
                for( int i = 0; i < SCREEN_HEIGHT; i += 4 )
                {
                    SDL_RenderDrawPoint( gRenderer, SCREEN_WIDTH / 2, i );
                }

                //Reset render target
                SDL_SetRenderTarget( gRenderer, NULL );

                //Show rendered to texture
                gTargetTexture.render( 0, 0, NULL, angle, &screenCenter );

                //Update screen
                SDL_RenderPresent( gRenderer );
            }
</div>

<div class="tutText">
In our main loop before we do any rendering we set the target texture as a target. We then render our scene full of geometry and once we're done rendering to a texture we call
SDL_SetRenderTarget with a NULL texture so any rendering done afterward will be done to the screen.<br/>
<br/>
With our scene rendered to a texture, we then render the target texture to the screen at a rotated angle.
</div>


            <div class="tutFooter">
            Download the media and source code for this tutorial <a class="tutLink" href="43_render_to_texture.zip">here</a>.<br/>
            <br/>
            <a class="leftNav" href="../index.php.html#Render to Texture">Back to SDL Tutorials</a><br>
            </div>

        </div>

        <div class="footer">

<div style="text-align: center;">
<!--Facebook-->
<span style="line-height: 10px;" class="fb-share-button" data-href="http://lazyfoo.net/" data-type="button_count"></span>

<!--Google+-->
<g:plus action="share" annotation="bubble" height=20 href="http://lazyfoo.net/"></g:plus>

<!--Twitter-->
<a style="line-height: 0px;" href="https://twitter.com/share" class="twitter-share-button" data-lang="en">Tweet</a>

</div>
<div class="nav">
<a class="nav" href="http://forums.libsdl.org/">SDL Forums</a>
<a class="nav" href="../index.php.html">SDL Tutorials</a>
<a class="nav" href="../../../articles/index.php.html">Articles</a>
<a class="nav" href="../../OpenGL/index.php.html">OpenGL Tutorials</a>
<a class="nav" href="http://www.opengl.org/discussion_boards/forum.php">OpenGL Forums</a>
<div class="ads">
<script type="text/javascript"><!--
google_ad_client = "pub-5880704953225255";
google_ad_width = 468;
google_ad_height = 60;
google_ad_format = "468x60_as";
google_ad_type = "text_image";
google_ad_channel ="";
google_color_border = "6699CC";
google_color_bg = "003366";
google_color_link = "FFFFFF";
google_color_url = "AECCEB";
google_color_text = "AECCEB";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</div><a class="nav" href="../../../index.php.html">News</a>
<a class="nav" href="../../../faq.php.html">FAQs</a>
<!--<a class="nav" href="http://lazyfoo.net/games/index.php">Games</a>-->
<a class="nav" href="../../../contact.php.html">Contact</a>
<a class="nav" href="../../../donate.php.html">Donations</a>

</div>
<h6>
Copyright Lazy Foo' Productions 2004-2018
</h6>

</div>
    </body>
</html>
